# from init
export REBUILD=${REBUILD-true}
export SKIP_CHECKS=${SKIP_CHECKS-true}

CI_TYPE=${CI_TYPE:-jenkins}

# from buildah-tssc
TAG=$(git rev-parse HEAD)
export IMAGE_URL=${IMAGE_URL-artifactory-docker-artifactory-jcr2.apps.rosa.rhtap-services.xmdt.p3.openshiftapps.com/rhtap/backend-tests-go-fazfjdjr:$CI_TYPE-$TAG}
export IMAGE=${IMAGE-$IMAGE_URL}

export DOCKERFILE=${DOCKERFILE-docker/Dockerfile}
export CONTEXT=${CONTEXT-.}
export TLSVERIFY=${TLSVERIFY-true}
export BUILD_ARGS=${BUILD_ARGS-""}
export BUILD_ARGS_FILE=${BUILD_ARGS_FILE-""}

# from ACS_*.*
export DISABLE_ACS=${DISABLE_ACS-false}
# Optionally set ROX_CENTRAL_ENDPOINT here instead of configuring a Jenkins secret
export ROX_CENTRAL_ENDPOINT="central-tssc-acs.apps.rhopp-test-clusterpool-sv8rn.rhtap.devcluster.openshift.com:443"
export INSECURE_SKIP_TLS_VERIFY=${INSECURE_SKIP_TLS_VERIFY-true}

# for gitops, if acs scans are set, we still may not want that repo 
# to be updates so include an option to disable

export DISABLE_GITOPS_UPDATE=${DISABLE_GITOPS_UPDATE-false}
export GITOPS_REPO_URL=https://github.com/rhopp-rhtap-testing/backend-tests-go-fazfjdjr-gitops

export PARAM_IMAGE=${PARAM_IMAGE-$IMAGE}
# Recompute this every time, otherwise it will be set BEFORE the file exists
# and be stuck at latest
export PARAM_IMAGE_DIGEST=$(cat "$BASE_RESULTS/buildah-tssc/IMAGE_DIGEST" 2>/dev/null || echo "latest")

# From Summary
export SOURCE_BUILD_RESULT_FILE=${SOURCE_BUILD_RESULT_FILE-""}

# gather images params
export CUSTOM_ROOT_CA="-----BEGIN CERTIFICATE-----
MIIDMjCCAhqgAwIBAgIITj2M2HwIkqswDQYJKoZIhvcNAQELBQAwNzESMBAGA1UE
CxMJb3BlbnNoaWZ0MSEwHwYDVQQDExhrdWJlLWFwaXNlcnZlci1sYi1zaWduZXIw
HhcNMjUxMTI1MDkwNzI5WhcNMzUxMTIzMDkwNzI5WjA3MRIwEAYDVQQLEwlvcGVu
c2hpZnQxITAfBgNVBAMTGGt1YmUtYXBpc2VydmVyLWxiLXNpZ25lcjCCASIwDQYJ
KoZIhvcNAQEBBQADggEPADCCAQoCggEBAMa1CDFu4lc9zSCVahCW2Ho1DOJzy0lM
hZaVkto+CuImo43zbAJHOn2FbcDgYrfNWchpW03nD3NA0Db2HNn78chAm6MZRey9
4lyEPrQHzlcVKkAnICrbFOdzehWNvIb41dblW/ABSnunHJFvwveyuJFRAtOff9bp
aM5m3soQ7hGWHPGtHeITI+p7laZA5J2Vc10UWPg4KLsmA+1Z8CevfNqMFwMenA4f
cTRT7Y5o7mHQIgz/TVI4HdGZJmx2Cmsf68f2mskYY+18K/FX7ZNo4KdbUE63Cr0o
DQYH9o1kw1tb0K16EUO+ybzQ4aYF7ieqzXwFCmhpdFVq00uQvJU7xJ8CAwEAAaNC
MEAwDgYDVR0PAQH/BAQDAgKkMA8GA1UdEwEB/wQFMAMBAf8wHQYDVR0OBBYEFMB8
MXeeQiPnXriPksaW8aEzZaFjMA0GCSqGSIb3DQEBCwUAA4IBAQAYKcPCu7ewi4f+
P0GgSrpDK/4CC7qn4uAygkdbiZuPed2vA/tjtarU4lg0nlS8ytrRtZd/8T+pwz4z
SpBx5viBuruWylhk4MWrNvFy4rByuamc6jJhgAnai6K0wLe9pmFD7pRbXCUOQQ6O
9VC4d5R3c75BuAH+85pMsgJe2IBToFDncLWv5lD6zx0GRh/inneHEGwjC3RSWbaw
6VWIPJfNqGbAi/QmIq6xKl8DXKt/WwKCtI6v6RJ+EfOaalsEbDSvfNsZC4zpEq2k
lzZ130BaKgZKQ8TatM2KIAG4xa5z9zCOHBKqmWoubS3H2Mw2NAnyCbCtjZkpjROE
aXJEV6gB
-----END CERTIFICATE-----
-----BEGIN CERTIFICATE-----
MIIDQDCCAiigAwIBAgIIYAz3gy+el/gwDQYJKoZIhvcNAQELBQAwPjESMBAGA1UE
CxMJb3BlbnNoaWZ0MSgwJgYDVQQDEx9rdWJlLWFwaXNlcnZlci1sb2NhbGhvc3Qt
c2lnbmVyMB4XDTI1MTEyNTA5MDcyOFoXDTM1MTEyMzA5MDcyOFowPjESMBAGA1UE
CxMJb3BlbnNoaWZ0MSgwJgYDVQQDEx9rdWJlLWFwaXNlcnZlci1sb2NhbGhvc3Qt
c2lnbmVyMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAynIBj8I6JZrW
05LFOa0KHLuer0W/MyiUR+iiTb1yBqKdQcdmM74LToKo5vVpcv9GrQlm6JtTZWAN
fs1D7gYarB/+qk6Df3kyDmXU61twmKpq12GqtbmeWDcaIPSq7jxsqf5gVL9xOpHN
JG1GgajZT6URsGJv2zszXCF/nXL+6ruIovVI2YrYdsh4i1ed147hELhZlXcCG1Gt
XtRSHuXC2fgnZxZsfAl+/xC5g0mZtNSk5av97IJPXboAnVIebk46VKfHofa1eM95
niuogMLWV5YyYTiIeFTKgkTCQ7uMLmWogznAHa69LyDEtmNDCx+vGDAneTk9691t
Ns56xe+erwIDAQABo0IwQDAOBgNVHQ8BAf8EBAMCAqQwDwYDVR0TAQH/BAUwAwEB
/zAdBgNVHQ4EFgQUkn9hZUrjObPZOX92O9D8gFZdAjAwDQYJKoZIhvcNAQELBQAD
ggEBACyW/LW4wdVr28b13SkzERKzejgwtmX2yBPImGludwDzlka6tVTgmAapGxR7
AUP9qsW8AUbi4l4h0qBTIgsR8ZLFmIHf2bMRMtm9VoiUYjihYXfNmAWtcRMS1vFu
TSPMJ7rRtwTCDQQ9Eq9X0GOQKuqP5+aOdmOhuHfQOgJ5aG9asoodJPFreRRWzOZD
7XlH+UFLOkxA4dzxIL0Pw3b5kV/dR1kJCcbkQErNVBjBK9xwyS0il/Cd4X8Jqv/V
8AuMF4xysFupf1MrYVq7syf4EzzPISYSyXT2IHMFTJt1LzSjW5MKNEwOQNGgcK8q
iUD0mGGl0nzNSqThoZVwWrsZYWc=
-----END CERTIFICATE-----
-----BEGIN CERTIFICATE-----
MIIDTDCCAjSgAwIBAgIIR+4zR8IFUlMwDQYJKoZIhvcNAQELBQAwRDESMBAGA1UE
CxMJb3BlbnNoaWZ0MS4wLAYDVQQDEyVrdWJlLWFwaXNlcnZlci1zZXJ2aWNlLW5l
dHdvcmstc2lnbmVyMB4XDTI1MTEyNTA5MDcyOVoXDTM1MTEyMzA5MDcyOVowRDES
MBAGA1UECxMJb3BlbnNoaWZ0MS4wLAYDVQQDEyVrdWJlLWFwaXNlcnZlci1zZXJ2
aWNlLW5ldHdvcmstc2lnbmVyMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKC
AQEAvNHZH4QZChqbq+ih5jn0fGpvUrHNn3m+1zmsYtpSqownj5W1yHEROBM3Cpkc
cCuQcxbc+zGhimEMBrdxJ/k/O1hQEif4Q2cMkOpuXxYaKuJ5CY53AZA0oGvWVY+8
vbSK5w26RBb2yP9L3/CtnfHFcfy4IKyKH+50nGgDeMYOWb+EVL7gPMPB/ZdfzUPG
EBI0W/DAYVH2QUM8ptuwmnjhILep4IAfvIDQbGBf+GN4TfU5RSsXc/UiphibO85Y
lAOeA/SwM26A4rCTUlFJEkYLdhmXPkZXNafqyl0pucFya8VE6q8LXOB432KRJ+fv
X8uiHnNpUwid/1sKj8mvDR+lgQIDAQABo0IwQDAOBgNVHQ8BAf8EBAMCAqQwDwYD
VR0TAQH/BAUwAwEB/zAdBgNVHQ4EFgQUgv/I9GYadOL8+MkZ3Kti27f1o28wDQYJ
KoZIhvcNAQELBQADggEBAFVJ72fakvlnu4bqnaQllO3NRbrjqpKLaPfa8fO9dyoX
esoQQ3eqpZRXBcV2SqRjBEGr6xJXyLdKMID6dtL/01ut5Tp6XzxTMyULGLjXj1Bc
l7XlEY0jZlK8R6C11NwfEy3IX2LtWdjdiIV0TSCnc3a2g2fy4Hf2y2ViO4Z60i4E
S2C6jMYWUPWffZX55skwvxzylF6WdSXsnI/yFtOn0faODujGVG9C4yL5dpyE9Dpy
4IVEcDfe0tKOOKwZklTMZI83AuJyExT4GEaYPPkFOOsB3DYRAnpHUOUFqNiJxTQR
cyHUWuS9jlFSOepa5H0NXESXvSl8eaImYAHqu3HzAEk=
-----END CERTIFICATE-----
-----BEGIN CERTIFICATE-----
MIIDlzCCAn+gAwIBAgIIMhdOTiOu2MIwDQYJKoZIhvcNAQELBQAwWTFXMFUGA1UE
AwxOb3BlbnNoaWZ0LWt1YmUtYXBpc2VydmVyLW9wZXJhdG9yX2xvY2FsaG9zdC1y
ZWNvdmVyeS1zZXJ2aW5nLXNpZ25lckAxNzY0MDYyNTg5MB4XDTI1MTEyNTA5MjMw
OFoXDTM1MTEyMzA5MjMwOVowWTFXMFUGA1UEAwxOb3BlbnNoaWZ0LWt1YmUtYXBp
c2VydmVyLW9wZXJhdG9yX2xvY2FsaG9zdC1yZWNvdmVyeS1zZXJ2aW5nLXNpZ25l
ckAxNzY0MDYyNTg5MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAl9pD
pAH8AvFaypKdisLfGvMNjeFvGKdyhhXKNFE92hdunpSxX7FUcHBdQ1za4wKZblO+
qSUftCHZLP0ViikCxGyIc7eJ8B7ocJgMSTy6jPS+hznDdpEPIjwIaD/G6nozRrsK
XJoD7qQ9RAg0dtNtRtltN7J1DLYHICzBz7hFU/kGY+dOonGBdOtO6hNv65DZ5e8W
u2q92pxcgUXn75+kWc2AJYog4g+k95jlGJ6v+xKTzOrLsDvDI/Td0e8dVefE6UtR
YmtenjFt6rKfRYRM4fCflx5RKNnZGqK13Kwkm7XR+KiZzjr+UUleCABrpmsqOcsN
kXQoiVataFI3ABdbDQIDAQABo2MwYTAOBgNVHQ8BAf8EBAMCAqQwDwYDVR0TAQH/
BAUwAwEB/zAdBgNVHQ4EFgQUTi0X4HUwZw6TY/Yc3ObAaB3XkYwwHwYDVR0jBBgw
FoAUTi0X4HUwZw6TY/Yc3ObAaB3XkYwwDQYJKoZIhvcNAQELBQADggEBADCrwSk9
kiVSMsQG1vuYCieiPv6dKmpw9uy8dImebFjZVQnOBXbnxidl8C5T7tpwVYfnioA1
HoaxMTg3Tkul9cd5JIAVsYmYw3zIyuNlTKuTxg382JpFpfTOA2HFEE9wDq4NX8Id
S1FfyUpYST44eZDcTooKss0t8gSEArCGP9lBn9BWTYCMjgq79PJtd78iADLF7+cL
joeWxGjklp2XHtHunmt1IZlZNnomvT3M6x5PcBPVL9V4Kcu9RalPPtovfZEQKw5v
QK02qPEVKrcEs8zBk+krDYXo02xsTbJKtpqJHRQq1xW1GivKgpzd5vCj4hCzvRMZ
UP7EHB6clObVOUg=
-----END CERTIFICATE-----
-----BEGIN CERTIFICATE-----
MIIDuzCCAqOgAwIBAgIIOdlyjOtwb1MwDQYJKoZIhvcNAQELBQAwJjEkMCIGA1UE
AwwbaW5ncmVzcy1vcGVyYXRvckAxNzY0MDYyNjIwMB4XDTI1MTEyNTA5MjM0MFoX
DTI3MTEyNTA5MjM0MVowTTFLMEkGA1UEAwxCKi5hcHBzLnJob3BwLXRlc3QtY2x1
c3RlcnBvb2wtc3Y4cm4ucmh0YXAuZGV2Y2x1c3Rlci5vcGVuc2hpZnQuY29tMIIB
IjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAzgpRcAy0SrEBfCWIKfIOarqe
LBcZtSfdcULz2qK15GdTA4HharMP0E9ojX6lURSYiumHsKVRr4rE6LbJMSBuzp6q
Vs79kT+fBlN9g+YXYDNSF4osctiMYhK1L3b5zvZS6DwFLlXFMHdkfeOOYm86+uaJ
wFUB19rBNnhEAXidvBjZPcEvdJxymMROSrow247t2sSUtx23UBNAoMnrWL9NuI5y
HqiLor5iGrJJWm9Pge0CZGPrD1DBKCGPS/ALzv1g9wQHCSAqGtT53pjjQbwP4mVC
VJxlYTR2x6rMvL6tm1c+p0heJB9qrnysKhRFZbRo32nE5iHlxVVOIWoorjq7iwID
AQABo4HFMIHCMA4GA1UdDwEB/wQEAwIFoDATBgNVHSUEDDAKBggrBgEFBQcDATAM
BgNVHRMBAf8EAjAAMB0GA1UdDgQWBBQ037UUan9WTPHmmmjAVV8h8Wd4UTAfBgNV
HSMEGDAWgBTxt7/Vwfwd9iTBzQ4Z3rzzVgbb3jBNBgNVHREERjBEgkIqLmFwcHMu
cmhvcHAtdGVzdC1jbHVzdGVycG9vbC1zdjhybi5yaHRhcC5kZXZjbHVzdGVyLm9w
ZW5zaGlmdC5jb20wDQYJKoZIhvcNAQELBQADggEBAIoebv2nTV7m7uLZPS4BsQWr
LakxMci38omM6JYB337LT7ynBzkN+1Leoz38yYDkFYpC3TL21357b3+jEw/3qE+A
RXE2EAsvZFcOgE/8ysq1/uYr/z5DWFMO0ChslgE6kME09E1aRgaAvjl67tcwVT+Z
1r1w0hKkp64d3T2Lrfu7F6xT2O7ROpGFC1FvVWD7DtIcEuJdRbtRWh6Dyl1RzWqq
Xk+NqeH/bVxjMUpHmbETbOTdYoZ7mXGHOZ621hzNL+Wtpix67UsyCjqMy/Ju4xxW
ZbBLQkBmOL1/dzqAJ7K8gYUdBBeB49A12Uwq4lUsQhtH8HiGk0g5RZKJEQaQ6G4=
-----END CERTIFICATE-----
-----BEGIN CERTIFICATE-----
MIIDDDCCAfSgAwIBAgIBATANBgkqhkiG9w0BAQsFADAmMSQwIgYDVQQDDBtpbmdy
ZXNzLW9wZXJhdG9yQDE3NjQwNjI2MjAwHhcNMjUxMTI1MDkyMzQwWhcNMjcxMTI1
MDkyMzQxWjAmMSQwIgYDVQQDDBtpbmdyZXNzLW9wZXJhdG9yQDE3NjQwNjI2MjAw
ggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQDBw93Xv7iPdx8pZX/yOrXm
82Ep+RQ6Aapoq+v+uwpVyCR4ybqzyeLZ0UpuSx4xEob6f8lOy7uv4IWhJhMj4U26
bkpTLD5ZpooZMJRsBLHq0Nq7qM8IaSrNU8ZfFeOwnQ0GeqlPQszGZj8A8FRf6azr
fNuUs5vXEL0v1Z0iJeXSLNk4j+tseYT2H5HRjhCTkKKI4F2SO8/DpdiqizSCEs+a
Zl6qAHQWBUz96NgP0E2WPpil7GzdGSAIZn7VBPWMLuhL1/O6ikEQ/m8+yLfKXEf0
IDy9v/4cHq1reGiVNCqtUgGSAOTYMu26F024AdFzq4NCqZAcOSLHu5Jk13LcLODN
AgMBAAGjRTBDMA4GA1UdDwEB/wQEAwICpDASBgNVHRMBAf8ECDAGAQH/AgEAMB0G
A1UdDgQWBBTxt7/Vwfwd9iTBzQ4Z3rzzVgbb3jANBgkqhkiG9w0BAQsFAAOCAQEA
iJWhWQWT8be3JWgDgBreHzRTj+EXv4r0OWBQmkcWLjEWmD7AtZIZXwej2rq8TSTj
9PulahEfXki66qVwvDj/nUmMdgvFhJ4s/cTF8kl++ltxeJUD/Msp2j2ZqV3cRqsR
vq9jBDP/mnan2kIIWtLsvjftX+zLrm5IhFk/5mVpC+lKt5hiBmaId4lHJfDyBgUb
xcXaRaHcco7PsOji3UVlDYGupsowuqiP+2dgAiRKN60z9Y7lvCpMF1IZX1VhMsFL
uHRg1v1rVreuvvC8UAd+v5zXw1DKZSuNTtlg/SJBxDpOCzHikKaJi5iOIZ4V5FoN
44m0WiuAwW4bht4uegCm6g==
-----END CERTIFICATE-----
"
export IMAGE_REGISTRY_USER="admin"
export COSIGN_PUBLIC_KEY="LS0tLS1CRUdJTiBQVUJMSUMgS0VZLS0tLS0KTUZrd0V3WUhLb1pJemowQ0FRWUlLb1pJemowREFRY0RRZ0FFSGkzaS83blc1MllraklDNUZENkFONGNuMEJHUgozMUVPNzRqWFRFS1l1WVNMM1JrWlF6aFZxWVQ4WG1pMHByRWVPNUxhMzQ1LzNFTW9OVjRWb0lRQ3NRPT0KLS0tLS1FTkQgUFVCTElDIEtFWS0tLS0tCg=="

export TARGET_BRANCH=${TARGET_BRANCH-""}
# conforma
export POLICY_CONFIGURATION=${POLICY_CONFIGURATION-"github.com/conforma/config//rhtap-v0.6"}
#internal, assumes jenkins is local openshift
export REKOR_HOST=${REKOR_HOST-https://rekor-server-tssc-tas.apps.rhopp-test-clusterpool-sv8rn.rhtap.devcluster.openshift.com}
export IGNORE_REKOR=${IGNORE_REKOR-false}
export INFO=${INFO-true}
export STRICT=${STRICT-true}
export EFFECTIVE_TIME=${EFFECTIVE_TIME-now}
export HOMEDIR=${HOMEDIR-$(pwd)}
export TUF_MIRROR=${TUF_MIRROR-https://tuf-tssc-tas.apps.rhopp-test-clusterpool-sv8rn.rhtap.devcluster.openshift.com}

export CUSTOM_ROOT_CA=${CUSTOM_ROOT_CA-""}

# Allow PR to succeed even if TAS vars not configured
export FAIL_IF_TRUSTIFICATION_NOT_CONFIGURED=false

export SBOMS_DIR=results/sboms